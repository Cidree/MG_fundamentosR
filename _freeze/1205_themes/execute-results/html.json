{
  "hash": "403ae0f7bbc2f0e22ca77d335923a53c",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexecute: \n  warning: false\neditor_options: \n  chunk_output_type: console\nfilters: \n    - webr\nwebr:\n    packages: [\"dplyr\", \"ggplot2\"]\n---\n\n\n\n\n# Themes {#sec-themes}\n\nEl sistemas de temas (*themes*) de `ggplot2` nos permite modificar todos aquellos elementos del gráfico que no tienen nada que ver con los datos. Estos no afectan a cómo los datos se compilan a través de las geometrías o cómo se transforman con las escalas [@book-ggplot2]. El objetivo de los temas es hacer la visualización mucho más atractiva\n\nEn este capítulo vamos a trabajar con tres *datasets*:\n\n-   `gapminder`: *dataset* con la evolución temporal del desarrollo económico, población y esperanza de vida de los países del mundo (ver [Tipos de visualización](#sec-visualization-types){target=\"_blank\"}). Filtraremos solamente los datos del 2002.\n\n-   `inventario`: *dataset* con datos de inventario forestal de 27 parcelas en los que se ha medido el DBH, altura y especie (ver @sec-vis-data).\n\n-   `iris`: se utilizará para los ejemplos utilizados en las explicaciones (ver [Tipos de visualización](#sec-visualization-types){target=\"_blank\"}).\n\nPara comenzar, vamos a cargar los paquetes necesarios y a leer los datos que utilizaremos en este capítulo.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Cargar paquetes\nlibrary(gapminder)\nlibrary(ggthemes)\nlibrary(patchwork)\nlibrary(tidyverse)\n## Cargar datos\ninventario_tbl <- read_rds(\"data/inventario_prep.rds\")\n```\n:::\n\n\n\n\n## El objeto ggplot2\n\nAntes de comenzar con los temas, vamos a observar la estructura de un objeto de `ggplot2`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg <- iris |> \n    ggplot(\n        aes(x = Petal.Length, fill = Species)\n    ) +\n    geom_histogram(bins = 30, color = \"white\") +\n    labs(\n        title    = \"Distribución de longitud del pétalo por especie\", \n        subtitle = \"La especie I. setosa tiene una longitud de pétalo menor que I. versicolor e I. virginica\",\n        x        = \"Longitud (mm)\", \n        y        = \"Frecuencia\",\n        caption  = \"Autor: Adrián Cidre\"\n    )\n\niris_gg\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\nEn este caso tenemos un histograma que hemos creado en la @sec-plot-distribution con el tema predefinido de `ggplot2`. Si vamos a la pestaña *Environment* podemos ver que es una lista con 11 elementos [@fig-ggplot2-list].\n\n![Estructura objeto ggplot2](images/ggplot2-list.png){#fig-ggplot2-list fig-align=\"center\"}\n\nEntre los 11 elementos tenemos uno que se llama `theme` y que podemos imprimir del siguiente modo:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg$theme\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nlist()\n```\n\n\n:::\n:::\n\n\n\n\nVemos que es una lista vacía. Si añadimos un tema completo o predefinido e imprimimos el tema de nuevo:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg <- iris_gg + theme_minimal()\n\niris_gg$theme\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 136\n $ line                            :List of 6\n  ..$ colour       : chr \"black\"\n  ..$ linewidth    : num 0.5\n  ..$ linetype     : num 1\n  ..$ lineend      : chr \"butt\"\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ rect                            :List of 5\n  ..$ fill         : chr \"white\"\n  ..$ colour       : chr \"black\"\n  ..$ linewidth    : num 0.5\n  ..$ linetype     : num 1\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ text                            :List of 11\n  ..$ family       : chr \"\"\n  ..$ face         : chr \"plain\"\n  ..$ colour       : chr \"black\"\n  ..$ size         : num 11\n  ..$ hjust        : num 0.5\n  ..$ vjust        : num 0.5\n  ..$ angle        : num 0\n  ..$ lineheight   : num 0.9\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ title                           : NULL\n $ aspect.ratio                    : NULL\n $ axis.title                      : NULL\n $ axis.title.x                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 2.75points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x.top                :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 2.75points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x.bottom             : NULL\n $ axis.title.y                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : num 90\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.75points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.y.left               : NULL\n $ axis.title.y.right              :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : num -90\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.75points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text                       :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : chr \"grey30\"\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 2.2points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.top                 :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 2.2points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.bottom              : NULL\n $ axis.text.y                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 1\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.y.left                : NULL\n $ axis.text.y.right               :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.2points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.theta                 : NULL\n $ axis.text.r                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0.5\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 2.2points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.ticks                      : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ axis.ticks.x                    : NULL\n $ axis.ticks.x.top                : NULL\n $ axis.ticks.x.bottom             : NULL\n $ axis.ticks.y                    : NULL\n $ axis.ticks.y.left               : NULL\n $ axis.ticks.y.right              : NULL\n $ axis.ticks.theta                : NULL\n $ axis.ticks.r                    : NULL\n $ axis.minor.ticks.x.top          : NULL\n $ axis.minor.ticks.x.bottom       : NULL\n $ axis.minor.ticks.y.left         : NULL\n $ axis.minor.ticks.y.right        : NULL\n $ axis.minor.ticks.theta          : NULL\n $ axis.minor.ticks.r              : NULL\n $ axis.ticks.length               : 'simpleUnit' num 2.75points\n  ..- attr(*, \"unit\")= int 8\n $ axis.ticks.length.x             : NULL\n $ axis.ticks.length.x.top         : NULL\n $ axis.ticks.length.x.bottom      : NULL\n $ axis.ticks.length.y             : NULL\n $ axis.ticks.length.y.left        : NULL\n $ axis.ticks.length.y.right       : NULL\n $ axis.ticks.length.theta         : NULL\n $ axis.ticks.length.r             : NULL\n $ axis.minor.ticks.length         : 'rel' num 0.75\n $ axis.minor.ticks.length.x       : NULL\n $ axis.minor.ticks.length.x.top   : NULL\n $ axis.minor.ticks.length.x.bottom: NULL\n $ axis.minor.ticks.length.y       : NULL\n $ axis.minor.ticks.length.y.left  : NULL\n $ axis.minor.ticks.length.y.right : NULL\n $ axis.minor.ticks.length.theta   : NULL\n $ axis.minor.ticks.length.r       : NULL\n $ axis.line                       : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ axis.line.x                     : NULL\n $ axis.line.x.top                 : NULL\n $ axis.line.x.bottom              : NULL\n $ axis.line.y                     : NULL\n $ axis.line.y.left                : NULL\n $ axis.line.y.right               : NULL\n $ axis.line.theta                 : NULL\n $ axis.line.r                     : NULL\n $ legend.background               : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.margin                   : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ legend.spacing                  : 'simpleUnit' num 11points\n  ..- attr(*, \"unit\")= int 8\n $ legend.spacing.x                : NULL\n $ legend.spacing.y                : NULL\n $ legend.key                      : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.key.size                 : 'simpleUnit' num 1.2lines\n  ..- attr(*, \"unit\")= int 3\n $ legend.key.height               : NULL\n $ legend.key.width                : NULL\n $ legend.key.spacing              : 'simpleUnit' num 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ legend.key.spacing.x            : NULL\n $ legend.key.spacing.y            : NULL\n $ legend.frame                    : NULL\n $ legend.ticks                    : NULL\n $ legend.ticks.length             : 'rel' num 0.2\n $ legend.axis.line                : NULL\n $ legend.text                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.text.position            : NULL\n $ legend.title                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.title.position           : NULL\n $ legend.position                 : chr \"right\"\n $ legend.position.inside          : NULL\n $ legend.direction                : NULL\n $ legend.byrow                    : NULL\n $ legend.justification            : chr \"center\"\n $ legend.justification.top        : NULL\n $ legend.justification.bottom     : NULL\n $ legend.justification.left       : NULL\n $ legend.justification.right      : NULL\n $ legend.justification.inside     : NULL\n $ legend.location                 : NULL\n $ legend.box                      : NULL\n $ legend.box.just                 : NULL\n $ legend.box.margin               : 'margin' num [1:4] 0cm 0cm 0cm 0cm\n  ..- attr(*, \"unit\")= int 1\n $ legend.box.background           : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.box.spacing              : 'simpleUnit' num 11points\n  ..- attr(*, \"unit\")= int 8\n  [list output truncated]\n - attr(*, \"class\")= chr [1:2] \"theme\" \"gg\"\n - attr(*, \"complete\")= logi TRUE\n - attr(*, \"validate\")= logi TRUE\n```\n\n\n:::\n:::\n\n\n\n\nVemos una lista enorme. Pues esto son básicamente los temas. Una lista enorme que podemos modificar a través de una función con muchos argumentos. Como podéis ver, algunos argumentos tienen valores, mientras que otros son NULL (estos últimos son argumentos vacíos).\n\n## Temas completos\n\nLos temas completos (*complete themes*) son aquellos que han sido creados por otras personas y que podemos utilizar a través de una función con pocos argumentos que tiene la estructura `*theme_*()`, donde \\* es el nombre del tema. Con el paquete `ggplot2` tenemos varios que vienen por defecto como son:\n\n```{shinylive-r}\n#| standalone: true\n#| viewerHeight: 600\n\n## Load packages\nlibrary(bslib)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(glue)\nlibrary(shiny)\n\n## UI\nui <- page_sidebar(\n    sidebar = sidebar(\n        open = \"open\",\n        width = 200,\n        selectInput(\n            inputId = \"theme\", \n            label   = \"Theme\",\n            choices =  c(\n                \"theme_bw\",         \n                \"theme_classic\",    \n                \"theme_dark\",       \n                \"theme_gray\",      \n                \"theme_light\",     \n                \"theme_linedraw\",  \n                \"theme_minimal\",    \n                \"theme_void\"\n                ),\n            selected = \"fixed\"\n        )\n    ),\n    verbatimTextOutput(\"code\") |> card(),\n    plotOutput(\"plot\", width = 500, height = 430) |> card()\n)\n\n## Server\nserver <- function(input, output, session) {\n    \n    output$code <- renderPrint({\n        glue(\n            '\n            iris_gg +\n                {input$theme}()\n            '\n            )\n    })\n\n    ## Plot\n    output$plot <- renderPlot({\n        iris |> \n            ggplot(\n                aes(x = Petal.Length, fill = Species)\n            ) +\n            geom_histogram(bins = 30, color = \"white\") +\n            labs(\n                title    = \"Distribución de longitud del pétalo por especie\", \n                subtitle = \"La especie I. setosa tiene una longitud de pétalo menor que I. versicolor e I. virginica\",\n                x        = \"Longitud (mm)\", \n                y        = \"Frecuencia\",\n                caption  = \"Autor: Adrián Cidre\"\n            ) +\n            get(input$theme)(base_size = 8)\n        }, res = 96\n    )\n}\n\n## Run app\nshinyApp(ui = ui, server = server)\n```\n\nExisten otros paquetes como `ggthemes` o `hrbhthemes` que traen más temas completos. En la siguiente aplicación puedes probar los disponibles en el paquete `ggthemes`:\n\n```{shinylive-r}\n#| standalone: true\n#| viewerHeight: 600\n\n## Load packages\nlibrary(bslib)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(glue)\nlibrary(shiny)\n\n## UI\nui <- page_sidebar(\n    sidebar = sidebar(\n        open = \"open\",\n        width = 250,\n        selectInput(\n            inputId = \"theme\", \n            label   = \"ggthemes\",\n            choices = c(\n              \"theme_economist\",\n              \"theme_economist_white\",\n              \"theme_few\",\n              \"theme_fivethirtyeight\",\n              \"theme_gdocs\",\n              \"theme_hc\",\n              \"theme_igray\",\n              \"theme_map\",\n              \"theme_pander\",\n              \"theme_par\",\n              \"theme_solarized\",\n              \"theme_solarized_2\",\n              \"theme_stata\",\n              \"theme_tufte\",\n              \"theme_wsj\"\n            ),\n            selected = \"fixed\"\n        )\n    ),\n    verbatimTextOutput(\"code\") |> card(),\n    plotOutput(\"plot\", width = 500, height = 430) |> card()\n)\n\n## Server\nserver <- function(input, output, session) {\n    \n    output$code <- renderPrint({\n        glue(\n            '\n            iris_gg +\n                {input$theme}()\n            '\n            )\n    })\n\n    ## Plot\n    output$plot <- renderPlot({\n        iris |> \n            ggplot(\n                aes(x = Petal.Length, fill = Species)\n            ) +\n            geom_histogram(bins = 30, color = \"white\") +\n            labs(\n                title    = \"Distribución de longitud del pétalo por especie\", \n                subtitle = \"La especie I. setosa tiene una longitud de pétalo menor que I. versicolor e I. virginica\",\n                x        = \"Longitud (mm)\", \n                y        = \"Frecuencia\",\n                caption  = \"Autor: Adrián Cidre\"\n            ) +\n            get(input$theme)(base_size = 8)\n        }, res = 96\n    )\n}\n\n## Run app\nshinyApp(ui = ui, server = server)\n```\n\nEstos temas son generalmente un buen punto de partida, pero en la mayoría de nuestras visualizaciones querremos ir más allá y controlar el aspecto de nuestros elementos de forma más concreta.\n\n## Modificar componentes\n\nSi queremos modificar elementos individuales vamos a utilizar la función `theme()`. Dentro de esta función vamos a utilizar una estructura particular para los argumentos:\n\n```         \niris_gg +\n    theme(\n        nombre_elemento = funcion_elemento(argumentos)\n)\n```\n\n-   **nombre_elemento**: el nombre del elemento se refiere a qué queremos modificar. En la @fig-theme-elements serían elementos como *plot.background, plot.title, legend.title, panel.background*...\n-   **funcion_elemento**: es una función que se aplica al elemento. Cada elemento tiene una sola función que va a ser *element_text, element_line* o *element_rect*. Además, todos los elementos puedes tener *element_blank* que es básicamente eliminar ese elemento.\n    -   `element_text`: será utilizada por elementos de texto tales como *plot.title, axis.text, legend.text, legend.title*, etc.\n    -   `element_line`: será utilizada por elementos lineares como las líneas de la grilla (*axis.line, panel.grid*) u otros (*axis.ticks*...).\n    -   `element_rect`: será utilizada por elementos rectangulares que tienen contorno y relleno (*panel.background, plot.background, legend.key, legend.background*...).\n    -   `element_blank`: eliminaremos el elemento.\n    -   Otros: existen otras funciones como `margin()` para establecer los márgenes de algún elemento o `unit()` para establecer dimensiones. También se puede modificar la posición de la leyenda como hemos visto en temas previos.\n\n![Elementos de tema](images/theme_elements.png){#fig-theme-elements fig-align=\"center\"}\n\n### Elementos de texto {#sec-element-text}\n\nCada función tiene unos elementos característicos. Por ejemplo, en `element_text` podremos modificar características como el tamaño de fuente, color de fuente, alineación del texto, ángulo del texto, etc. En el siguiente ejemplo se pueden explorar algunas de estas opciones:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg +\n    theme_minimal() +\n    theme(\n        plot.title = element_text(\n            face   = \"bold\",\n            size   = 20,\n            colour = \"darkblue\",\n            hjust  = .5,\n            margin = margin(b = 10, unit = \"pt\")\n        )\n    )\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\nEn este caso estamos modificando el título del gráfico. Lo convertimos a negrita (`face = \"bold\"`), con un tamaño de 20 puntos tipográficos (pt), color azul oscuro, justificación horizontal centrada y con un margen inferior (b = bottom) de 10 puntos. De este modo podemos modificar todos los elementos de texto:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg <- iris_gg +\n    theme_minimal() +\n    theme(\n        ## Título del gráfico\n        plot.title = element_text(\n            face   = \"bold\",\n            size   = 20,\n            colour = \"darkblue\",\n            hjust  = .5,\n            margin = margin(b = 10, unit = \"pt\")\n        ),\n        ## Título de la leyenda\n        legend.title = element_text(\n            face  = \"bold\",\n            hjust = .5\n        ),\n        ## Texto de los ejes X e Y\n        axis.text = element_text(\n            size = 12\n        ),\n        ## Texto del eje Y\n        axis.text.y = element_text(\n            angle = 90\n        ),\n        ## Títulos de los ejes\n        axis.title = element_text(\n            hjust = 1\n        ),\n        ## Pie de figura\n        plot.caption = element_text(\n            face  = \"italic\",\n            hjust = .5,\n            margin = margin(t = 10)\n        )\n    )\n\niris_gg\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n### Elementos lineales\n\nLos elementos lineales tienen argumentos característicos de las líneas como pueden ser: color, tipo de línea o grosor entre otros. Vamos a ver como modificar la grilla del gráfico:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg <- iris_gg +\n    theme(\n        ## Grilla mayor\n        panel.grid.major = element_line(\n            colour    = \"gray30\",\n            linewidth = .5\n        ),\n        ## Grilla menor\n        panel.grid.minor = element_line(\n            colour    = \"gray50\",\n            linetype  = 3,\n            linewidth = .3\n        ),\n        ## Ticks\n        axis.ticks = element_blank(),\n        axis.line  = element_blank()\n    )\n\niris_gg\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\nEste gráfico es un crimen, ya que la grilla resalta más que los propios datos. No obstante, es simplemente un ejemplo para que se pueda observar la influencia y función de cada uno de los argumentos.\n\n### Elementos rectangulares\n\nLos elementos rectangulares tienen contornos (líneas) y relleno. Los contornos van a poder modificarse al igual que cualquier otra línea (color, tipo de línea, grosor ...), mientras que el relleno tendrá el argumento *fill* para el color.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg <- iris_gg + \n    theme(\n        ## Panel del gráfico\n        panel.background = element_rect(\n            fill = \"grey95\",\n            colour = \"grey5\"\n        ),\n        ## Panel + resto del gráfico\n        plot.background = element_rect(\n            fill      = \"grey85\",\n            colour    = \"grey5\",\n            linewidth = 2\n        ),\n        ## Leyenda\n        legend.background = element_rect(\n            fill   = \"snow\",\n            colour = \"black\"\n        )\n    )\n\niris_gg\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\nEl elemento `plot.background` se refiere a todo el gráfico, envolviendo al panel. El `panel.background` es el rectángulo envuelto por los ejes.\n\n### Elementos vacíos\n\nPara eliminar elementos, utilizamos `element_blank()`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg <- iris_gg +\n    theme(\n        panel.grid.minor = element_blank(),\n        panel.grid.major = element_blank()\n    )\n\niris_gg\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\nDe este modo podemos eliminar la grilla que era horrible.\n\n### Márgenes\n\nLos márgenes se pueden modificar con la función `margin()`. En la @sec-element-text hemos visto un par de ejemplos de esta función que se puede utilizar dentro de `element_text(margin = margin(...)`. No obstante, tenemos otros elementos a los que solamente podremos modificar el margen. Vamos a ver estos dos ejemplos de nuevo:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_gg <- iris_gg +\n    theme(\n        plot.subtitle = element_text(\n            hjust = .5,\n            margin = margin(b = 5)\n        ),\n        plot.margin = margin(\n            t    = 10,\n            r    = 15,\n            b    = 10,\n            l    = 15,\n            unit = \"pt\"\n        )\n    )\n\niris_gg\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n\nEn este ejemplo vemos como añadir margen a un elemento de texto y al gráfico en su conjunto.\n\n### Leyenda\n\nLa leyenda tiene un par de elementos especiales:\n\n-   Posición de la leyenda: la podemos modificar con:\n\n    -   `legend.position.inside`: lo igualamos a un vector numérico con coordenadas dentro del gráfico (entre 0 y 1). Este argumento debe ser usado en conjunto con `guides`.\n\n    -   `legend.position`: para una posición absoluta (*top, right, bottom, left*). Todavía se puede utilizar un vector numérico en este elemento, pero esto ha quedado obsoleto en la versión 3.5.0 de `ggplot2` y es posible que se elimine en un futuro cercano.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Posición absoluta\niris_abs_gg <- iris_gg +\n    theme(\n        legend.position = \"top\"\n    )\n\n## Posición dentro del gráfico\niris_ins_gg <- iris_gg +\n    guides(\n        fill = guide_legend(\n            position       = \"inside\"\n        )\n    ) +\n    theme(\n        legend.position.inside = c(.8, .8)\n    )\n\n## Visualizar ambos con patchwork\niris_abs_gg + iris_ins_gg\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n\nOtros elementos sobre los que podemos actuar dentro de `theme` son los iconos denominados *keys*. Podemos modificar su tamaño con la función `unit()` que toma dos argumentos: el tamaño y las unidades.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris_ins_gg +\n    theme(\n        legend.key.height = unit(5, \"mm\"),\n        legend.key.width  = unit(10, \"mm\")\n    )\n```\n\n::: {.cell-output-display}\n![](1205_themes_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n\nExisten muchos otros elementos con los que experimentar, pero entendiendo lo visto en este tema podréis ser capaces de modificar cualquier elemento de `theme`. Para explorar estos elementos podéis abrir la ayuda de la función `?theme`.\n\n## Resumen\n\nEn este capítulo hemos visto el último componente de `ggplot2` que son los temas. Tenemos temas predefinidos que en algunas ocasiones serán suficientes, aunque en la mayoría de las ocasiones vamos a modificar otros elementos. Tenemos tres clases de elementos principales: `element_text`, `element_line` y `element_rect`, que clasifican a los elementos según su forma: texto, línea o rectángulo. Cada una de estas clases tiene argumentos específicos que nos permiten personalizar nuestros gráficos de manera exhaustiva, brindándonos la capacidad de ajustar hasta el más mínimo detalle. De esta forma, la única limitación para el diseño de nuestros gráficos será nuestra propia creatividad.\n",
    "supporting": [
      "1205_themes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}